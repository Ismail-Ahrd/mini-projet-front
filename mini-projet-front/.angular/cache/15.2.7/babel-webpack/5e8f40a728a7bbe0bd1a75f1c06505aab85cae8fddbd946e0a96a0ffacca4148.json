{"ast":null,"code":"import { Detail } from \"../../models/detail.model\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"../../services/resultat-prelevement.service\";\nimport * as i4 from \"@angular/common\";\nfunction ResultatUpdateComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵelement(1, \"div\", 11);\n    i0.ɵɵelementStart(2, \"div\", 0);\n    i0.ɵɵtext(3, \"D\\u00E9tail de non conformit\\u00E9\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 3)(5, \"div\", 4)(6, \"label\");\n    i0.ɵɵtext(7, \"Num\\u00E9ro TA:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(8, \"input\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 4)(10, \"label\");\n    i0.ɵɵtext(11, \"Date TA:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(12, \"input\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 4)(14, \"label\");\n    i0.ɵɵtext(15, \"D\\u00E9tail:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(16, \"input\", 14);\n    i0.ɵɵelementEnd()()();\n  }\n}\nexport class ResultatUpdateComponent {\n  constructor(route, fb, resultatService, router) {\n    this.route = route;\n    this.fb = fb;\n    this.resultatService = resultatService;\n    this.router = router;\n    this.detail = new Detail();\n  }\n  ngOnInit() {\n    this.route.paramMap.subscribe(params => {\n      const resultatString = params.get('resultat');\n      if (typeof resultatString === \"string\") {\n        this.resultat = JSON.parse(resultatString);\n      }\n      console.log(this.resultat);\n    });\n    this.resultatFormGroup = this.fb.group({\n      dateBA: this.fb.control(this.resultat.dateBA.toString().substring(0, 10)),\n      numeroBA: this.fb.control(this.resultat.numeroBA),\n      conforme: this.fb.control(this.resultat.conforme ? 'Oui' : 'Non'),\n      dateTA: this.fb.control(this.resultat.numeroTA != undefined ? this.resultat.dateTA.toString().substring(0, 10) : null),\n      numeroTA: this.fb.control(this.resultat.numeroTA != undefined ? this.resultat.numeroTA : null),\n      detail: this.fb.control(this.resultat.numeroTA != undefined ? this.resultat.detail : null)\n    });\n  }\n  onSubmit() {\n    console.log(this.resultatFormGroup.value);\n    this.resultat.dateBA = this.resultatFormGroup.value.dateBA;\n    this.resultat.numeroBA = this.resultatFormGroup.value.numeroBA;\n    let jwt = localStorage.getItem('token');\n    let jwtData = '';\n    if (jwt) jwtData = jwt.split('.')[1];\n    let decodedJwtJsonData = window.atob(jwtData);\n    let decodedJwtData = JSON.parse(decodedJwtJsonData);\n    let idPersonne = decodedJwtData.idPersonne;\n    this.resultat.idPersonne = idPersonne;\n    if (this.resultatFormGroup.value.conforme == \"Oui\") {\n      this.resultat.conforme = true;\n    } else {\n      this.resultat.conforme = false;\n      this.detail.dateTA = this.resultatFormGroup.value.dateTA;\n      this.detail.detail = this.resultatFormGroup.value.detail;\n      this.detail.numeroTA = this.resultatFormGroup.value.numeroTA;\n    }\n    let detail2;\n    this.resultatService.saveresultat(this.resultat).subscribe({\n      next: resultat => {\n        this.resultatService.getDetailNonConformite(resultat.id).subscribe({\n          next: data => {\n            detail2 = data;\n            if (!detail2 && this.resultat.conforme) {\n              console.log(\"oui to oui\");\n              this.router.navigate(['resultatPrelevements']);\n            } else if (!detail2 && !this.resultat.conforme) {\n              console.log(\"oui to non\");\n              this.resultatService.saveDetailNonConformite(this.detail).subscribe({\n                next: data => {\n                  console.log(\"Detail Saved\");\n                  console.log(data);\n                },\n                error: err => console.log(\"Error in saving detail\", err)\n              });\n            } else if (detail2 && this.resultat.conforme) {\n              console.log(\"non to oui\");\n              this.resultatService.deleteDetail(resultat.id).subscribe({\n                next: data => {\n                  console.log(\"Detail Deleted\");\n                },\n                error: err => console.log(\"Error in deleting detail\", err)\n              });\n            } else if (detail2 && !this.resultat.conforme) {\n              console.log(\"non to non\");\n              this.resultatService.getDetailNonConformite(this.resultat.id).subscribe({\n                next: data => {\n                  console.log(\"Getting detail\");\n                  console.log(data);\n                  this.detail.id = data.id;\n                  this.detail.idResultat = data.idResultat;\n                  console.log(this.detail);\n                  this.resultatService.saveDetailNonConformite(this.detail).subscribe({\n                    next: data => {\n                      console.log(\"Detail Updated\");\n                      console.log(data);\n                      this.router.navigate(['resultatPrelevements']);\n                    },\n                    error: err => console.log(console.log(\"Detail Updated failed\"), err)\n                  });\n                },\n                error: err => console.log(\"Error in getting detail, err\")\n              });\n            }\n          },\n          error: err => console.log(\"Error in getting detail first\")\n        });\n        /*if (resultat.conforme && this.resultat.conforme) {\r\n          this.router.navigate(['resultatPrelevements'])\r\n        } else if (resultat.conforme && !this.resultat.conforme) {\r\n          this.resultatService.saveDetailNonConformite(this.detail).subscribe({\r\n            next: data => {\r\n              console.log(\"Detail Saved\");\r\n              console.log(data);\r\n            }, error: err => console.log(err)\r\n          });\r\n        } else if (!resultat.conforme && this.resultat.conforme) {\r\n          this.resultatService.deleteDetail(resultat.id).subscribe({\r\n            next: data => {\r\n              console.log(\"Detail Deleted\");\r\n            }, error: err => console.log(err)\r\n          })\r\n        } else if (!resultat.conforme && !this.resultat.conforme) {\r\n          this.resultatService.getDetailNonConformite(this.resultat.id).subscribe({\r\n            next: data => {\r\n              console.log(\"Getting detail\")\r\n              console.log(data)\r\n              this.detail.id=data.id\r\n              this.detail.idResultat=data.idResultat\r\n              console.log(this.detail)\r\n              this.resultatService.saveDetailNonConformite(this.detail).subscribe({\r\n                next: data => {\r\n                  console.log(\"Detail Updated\");\r\n                  console.log(data);\r\n                  this.router.navigate(['resultatPrelevements'])\r\n                }, error: err => console.log(console.log(\"Detail Updated failed\"), err)\r\n              });\r\n            }, error: err => console.log(\"Error in getting detail, err\")\r\n          })\r\n        }*/\n      },\n\n      error: err => console.log(err)\n    });\n  }\n}\nResultatUpdateComponent.ɵfac = function ResultatUpdateComponent_Factory(t) {\n  return new (t || ResultatUpdateComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.ResultatPrelevementService), i0.ɵɵdirectiveInject(i1.Router));\n};\nResultatUpdateComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ResultatUpdateComponent,\n  selectors: [[\"app-resultat-update\"]],\n  decls: 24,\n  vars: 4,\n  consts: [[1, \"header\"], [3, \"formGroup\", \"ngSubmit\"], [\"f\", \"ngForm\"], [1, \"my_container\"], [1, \"Nom\"], [\"placeholder\", \"ex:2334\", \"type\", \"text\", \"formControlName\", \"numeroBA\", \"name\", \"numeroBA\", \"required\", \"\", \"number\", \"\"], [\"type\", \"date\", \"formControlName\", \"dateBA\", \"name\", \"date_BA\", \"required\", \"\"], [\"formControlName\", \"conforme\", \"name\", \"choix\"], [\"class\", \"my_container2\", 4, \"ngIf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\", 3, \"disabled\"], [1, \"my_container2\"], [1, \"liner\"], [\"placeholder\", \"ex:2334\", \"type\", \"text\", \"formControlName\", \"numeroTA\", \"name\", \"Num\\u00E9roTA\", \"required\", \"\", \"number\", \"\"], [\"type\", \"Date\", \"formControlName\", \"dateTA\", \"name\", \"DateTA\", \"required\", \"\"], [\"type\", \"text\", \"formControlName\", \"detail\", \"name\", \"D\\u00E9tail\", \"required\", \"\"]],\n  template: function ResultatUpdateComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtext(1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"form\", 1, 2);\n      i0.ɵɵlistener(\"ngSubmit\", function ResultatUpdateComponent_Template_form_ngSubmit_2_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵelementStart(4, \"div\", 3)(5, \"div\", 4)(6, \"label\");\n      i0.ɵɵtext(7, \"Num\\u00E9ro BA:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(8, \"input\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"div\", 4)(10, \"label\");\n      i0.ɵɵtext(11, \"Date de BA:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(12, \"input\", 6);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"div\", 4)(14, \"label\");\n      i0.ɵɵtext(15, \"Conformit\\u00E9:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(16, \"select\", 7)(17, \"option\");\n      i0.ɵɵtext(18, \"Oui\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(19, \"option\");\n      i0.ɵɵtext(20, \"Non\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵtemplate(21, ResultatUpdateComponent_div_21_Template, 17, 0, \"div\", 8);\n      i0.ɵɵelementStart(22, \"button\", 9);\n      i0.ɵɵtext(23, \"Soumettre\");\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      const _r0 = i0.ɵɵreference(3);\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate1(\" Enregister les r\\u00E9sultats de pr\\u00E9l\\u00E8vement d'\\u00E9chantillons:\", ctx.resultat.idPrelevement, \"\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formGroup\", ctx.resultatFormGroup);\n      i0.ɵɵadvance(19);\n      i0.ɵɵproperty(\"ngIf\", ctx.resultatFormGroup.value.conforme === \"Non\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"disabled\", !_r0.valid);\n    }\n  },\n  dependencies: [i4.NgIf, i2.ɵNgNoValidate, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.DefaultValueAccessor, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.RequiredValidator, i2.FormGroupDirective, i2.FormControlName],\n  styles: [\".header[_ngcontent-%COMP%]{\\r\\n    padding-top: 1.5rem;\\r\\n    text-align: center;\\r\\n    font-weight: 500;\\r\\n    font-size: 25px;\\r\\n    color: #6095C1;\\r\\n}\\r\\n@media(max-width:700px){\\r\\n    .header[_ngcontent-%COMP%]{\\r\\n        display: flex;\\r\\n    }\\r\\n}\\r\\n\\r\\n\\r\\n\\r\\nform[_ngcontent-%COMP%]{\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n.my_container[_ngcontent-%COMP%] {\\r\\n    margin-top: 30px;\\r\\n    width: 50%;\\r\\n    display: grid;\\r\\n    grid-template-columns: 40% 40% ;\\r\\n    column-gap: 20%;\\r\\n}\\r\\n\\r\\n.my_container2[_ngcontent-%COMP%] {\\r\\n    width: 100%;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n.Nom[_ngcontent-%COMP%]{\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    margin-bottom: 15px;\\r\\n}\\r\\n\\r\\n.Nom[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .Nom[_ngcontent-%COMP%]   select[_ngcontent-%COMP%] {\\r\\n    width: 250px;\\r\\n    height: 35px;\\r\\n    margin-top: 10px;\\r\\n}\\r\\n\\r\\n.Nom[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\\r\\n    font-size: 15px;\\r\\n    padding: 10px;\\r\\n}\\r\\n\\r\\n\\r\\nform[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{\\r\\n    justify-content: start;\\r\\n\\r\\n}\\r\\nbutton[_ngcontent-%COMP%]{\\r\\n    background-color: #05F300;\\r\\n    color: white;\\r\\n    border: none;\\r\\n    font-weight: 600;\\r\\n    font-size: 20px;\\r\\n    padding: 10px 20px;\\r\\n    border-radius: 10px;\\r\\n    margin-top: 15px;\\r\\n}\\r\\n\\r\\nbutton[_ngcontent-%COMP%]:hover {\\r\\n    cursor: pointer;\\r\\n    opacity: 0.9;\\r\\n}\\r\\n\\r\\n.formvalid[_ngcontent-%COMP%]{\\r\\n    opacity: 0.3;\\r\\n}\\r\\ninput.ng-invalid.ng-touched[_ngcontent-%COMP%]{\\r\\n    border: 1px solid red;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9yZXN1bHRhdC11cGRhdGUvcmVzdWx0YXQtdXBkYXRlLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxtQkFBbUI7SUFDbkIsa0JBQWtCO0lBQ2xCLGdCQUFnQjtJQUNoQixlQUFlO0lBQ2YsY0FBYztBQUNsQjtBQUNBO0lBQ0k7UUFDSSxhQUFhO0lBQ2pCO0FBQ0o7Ozs7QUFJQTtJQUNJLGFBQWE7SUFDYixzQkFBc0I7SUFDdEIsbUJBQW1CO0FBQ3ZCOztBQUVBO0lBQ0ksZ0JBQWdCO0lBQ2hCLFVBQVU7SUFDVixhQUFhO0lBQ2IsK0JBQStCO0lBQy9CLGVBQWU7QUFDbkI7O0FBRUE7SUFDSSxXQUFXO0lBQ1gsYUFBYTtJQUNiLHNCQUFzQjtJQUN0QixtQkFBbUI7QUFDdkI7O0FBRUE7SUFDSSxhQUFhO0lBQ2Isc0JBQXNCO0lBQ3RCLG1CQUFtQjtBQUN2Qjs7QUFFQTtJQUNJLFlBQVk7SUFDWixZQUFZO0lBQ1osZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0ksZUFBZTtJQUNmLGFBQWE7QUFDakI7OztBQUdBO0lBQ0ksc0JBQXNCOztBQUUxQjtBQUNBO0lBQ0kseUJBQXlCO0lBQ3pCLFlBQVk7SUFDWixZQUFZO0lBQ1osZ0JBQWdCO0lBQ2hCLGVBQWU7SUFDZixrQkFBa0I7SUFDbEIsbUJBQW1CO0lBQ25CLGdCQUFnQjtBQUNwQjs7QUFFQTtJQUNJLGVBQWU7SUFDZixZQUFZO0FBQ2hCOztBQUVBO0lBQ0ksWUFBWTtBQUNoQjtBQUNBO0lBQ0kscUJBQXFCO0FBQ3pCIiwic291cmNlc0NvbnRlbnQiOlsiLmhlYWRlcntcclxuICAgIHBhZGRpbmctdG9wOiAxLjVyZW07XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICBmb250LXdlaWdodDogNTAwO1xyXG4gICAgZm9udC1zaXplOiAyNXB4O1xyXG4gICAgY29sb3I6ICM2MDk1QzE7XHJcbn1cclxuQG1lZGlhKG1heC13aWR0aDo3MDBweCl7XHJcbiAgICAuaGVhZGVye1xyXG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5cclxuZm9ybXtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxufVxyXG5cclxuLm15X2NvbnRhaW5lciB7XHJcbiAgICBtYXJnaW4tdG9wOiAzMHB4O1xyXG4gICAgd2lkdGg6IDUwJTtcclxuICAgIGRpc3BsYXk6IGdyaWQ7XHJcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDQwJSA0MCUgO1xyXG4gICAgY29sdW1uLWdhcDogMjAlO1xyXG59XHJcblxyXG4ubXlfY29udGFpbmVyMiB7XHJcbiAgICB3aWR0aDogMTAwJTtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxufVxyXG5cclxuLk5vbXtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgbWFyZ2luLWJvdHRvbTogMTVweDtcclxufVxyXG5cclxuLk5vbSBpbnB1dCwgLk5vbSBzZWxlY3Qge1xyXG4gICAgd2lkdGg6IDI1MHB4O1xyXG4gICAgaGVpZ2h0OiAzNXB4O1xyXG4gICAgbWFyZ2luLXRvcDogMTBweDtcclxufVxyXG5cclxuLk5vbSBpbnB1dCB7XHJcbiAgICBmb250LXNpemU6IDE1cHg7XHJcbiAgICBwYWRkaW5nOiAxMHB4O1xyXG59XHJcblxyXG5cclxuZm9ybSBidXR0b257XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHN0YXJ0O1xyXG5cclxufVxyXG5idXR0b257XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDVGMzAwO1xyXG4gICAgY29sb3I6IHdoaXRlO1xyXG4gICAgYm9yZGVyOiBub25lO1xyXG4gICAgZm9udC13ZWlnaHQ6IDYwMDtcclxuICAgIGZvbnQtc2l6ZTogMjBweDtcclxuICAgIHBhZGRpbmc6IDEwcHggMjBweDtcclxuICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7XHJcbiAgICBtYXJnaW4tdG9wOiAxNXB4O1xyXG59XHJcblxyXG5idXR0b246aG92ZXIge1xyXG4gICAgY3Vyc29yOiBwb2ludGVyO1xyXG4gICAgb3BhY2l0eTogMC45O1xyXG59XHJcblxyXG4uZm9ybXZhbGlke1xyXG4gICAgb3BhY2l0eTogMC4zO1xyXG59XHJcbmlucHV0Lm5nLWludmFsaWQubmctdG91Y2hlZHtcclxuICAgIGJvcmRlcjogMXB4IHNvbGlkIHJlZDtcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["Detail","i0","ResultatUpdateComponent","constructor","route","fb","resultatService","router","ngOnInit","paramMap","subscribe","params","resultatString","get","resultat","JSON","parse","console","log","resultatFormGroup","group","dateBA","control","toString","substring","numeroBA","conforme","dateTA","numeroTA","undefined","detail","onSubmit","value","jwt","localStorage","getItem","jwtData","split","decodedJwtJsonData","window","atob","decodedJwtData","idPersonne","detail2","saveresultat","next","getDetailNonConformite","id","data","navigate","saveDetailNonConformite","error","err","deleteDetail","idResultat","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\hp\\OneDrive\\Desktop\\Nouveau dossier (5)\\mini-projet-front\\mini-projet-front\\src\\app\\components\\resultat-update\\resultat-update.component.ts","C:\\Users\\hp\\OneDrive\\Desktop\\Nouveau dossier (5)\\mini-projet-front\\mini-projet-front\\src\\app\\components\\resultat-update\\resultat-update.component.html"],"sourcesContent":["import {Component, OnInit} from '@angular/core';\nimport {ActivatedRoute, Router} from \"@angular/router\";\nimport {ResultatPrelevementDtos} from \"../../models/resultatPrelevement.model\";\nimport {FormBuilder, FormGroup} from \"@angular/forms\";\nimport {Detail} from \"../../models/detail.model\";\nimport {ResultatPrelevementService} from \"../../services/resultat-prelevement.service\";\n\n@Component({\n  selector: 'app-resultat-update',\n  templateUrl: './resultat-update.component.html',\n  styleUrls: ['./resultat-update.component.css']\n})\nexport class ResultatUpdateComponent implements OnInit{\n  resultat!: ResultatPrelevementDtos;\n  resultatFormGroup!: FormGroup;\n  detail: Detail = new Detail();\n\n  constructor(private route: ActivatedRoute, private fb: FormBuilder,\n              private resultatService: ResultatPrelevementService,\n              private router: Router) {\n  }\n\n  ngOnInit(): void {\n    this.route.paramMap.subscribe(params => {\n      const resultatString = params.get('resultat');\n      if (typeof resultatString === \"string\") {\n        this.resultat = JSON.parse(resultatString);\n      }\n      console.log(this.resultat);\n    });\n\n    this.resultatFormGroup = this.fb.group({\n      dateBA: this.fb.control(this.resultat.dateBA.toString().substring(0,10)),\n      numeroBA: this.fb.control(this.resultat.numeroBA),\n      conforme: this.fb.control(this.resultat.conforme?'Oui':'Non'),\n      dateTA: this.fb.control(this.resultat.numeroTA!=undefined?this.resultat.dateTA.toString().substring(0,10):null),\n      numeroTA: this.fb.control(this.resultat.numeroTA!=undefined?this.resultat.numeroTA:null),\n      detail: this.fb.control(this.resultat.numeroTA!=undefined?this.resultat.detail:null),\n    })\n\n  }\n\n  onSubmit() {\n    console.log(this.resultatFormGroup.value);\n    this.resultat.dateBA=this.resultatFormGroup.value.dateBA;\n    this.resultat.numeroBA=this.resultatFormGroup.value.numeroBA;\n    let jwt: string | null = localStorage.getItem('token');\n    let jwtData: string = '';\n    if (jwt) jwtData = jwt.split('.')[1];\n    let decodedJwtJsonData = window.atob(jwtData);\n    let decodedJwtData = JSON.parse(decodedJwtJsonData);\n    let idPersonne = decodedJwtData.idPersonne;\n    this.resultat.idPersonne=idPersonne;\n    if(this.resultatFormGroup.value.conforme==\"Oui\"){\n      this.resultat.conforme=true;\n    }\n    else{\n      this.resultat.conforme=false;\n      this.detail.dateTA=this.resultatFormGroup.value.dateTA;\n      this.detail.detail=this.resultatFormGroup.value.detail;\n      this.detail.numeroTA=this.resultatFormGroup.value.numeroTA;\n    }\n\n    let detail2: Detail | undefined;\n    this.resultatService.saveresultat(this.resultat).subscribe({\n      next: resultat => {\n\n        this.resultatService.getDetailNonConformite(resultat.id).subscribe({\n          next: data => {\n            detail2=data\n            if (!detail2 && this.resultat.conforme) {\n              console.log(\"oui to oui\")\n              this.router.navigate(['resultatPrelevements'])\n            } else if (!detail2 && !this.resultat.conforme) {\n              console.log(\"oui to non\")\n              this.resultatService.saveDetailNonConformite(this.detail).subscribe({\n                next: data => {\n                  console.log(\"Detail Saved\");\n                  console.log(data);\n                }, error: err => console.log(\"Error in saving detail\", err)\n              });\n            } else if (detail2 && this.resultat.conforme) {\n              console.log(\"non to oui\")\n              this.resultatService.deleteDetail(resultat.id).subscribe({\n                next: data => {\n                  console.log(\"Detail Deleted\");\n                }, error: err => console.log(\"Error in deleting detail\", err)\n              })\n            } else if (detail2 && !this.resultat.conforme) {\n              console.log(\"non to non\")\n              this.resultatService.getDetailNonConformite(this.resultat.id).subscribe({\n                next: data => {\n                  console.log(\"Getting detail\")\n                  console.log(data)\n                  this.detail.id=data.id\n                  this.detail.idResultat=data.idResultat\n                  console.log(this.detail)\n                  this.resultatService.saveDetailNonConformite(this.detail).subscribe({\n                    next: data => {\n                      console.log(\"Detail Updated\");\n                      console.log(data);\n                      this.router.navigate(['resultatPrelevements'])\n                    }, error: err => console.log(console.log(\"Detail Updated failed\"), err)\n                  });\n                }, error: err => console.log(\"Error in getting detail, err\")\n              })\n            }\n\n          }, error: err => console.log(\"Error in getting detail first\")\n        })\n\n        /*if (resultat.conforme && this.resultat.conforme) {\n          this.router.navigate(['resultatPrelevements'])\n        } else if (resultat.conforme && !this.resultat.conforme) {\n          this.resultatService.saveDetailNonConformite(this.detail).subscribe({\n            next: data => {\n              console.log(\"Detail Saved\");\n              console.log(data);\n            }, error: err => console.log(err)\n          });\n        } else if (!resultat.conforme && this.resultat.conforme) {\n          this.resultatService.deleteDetail(resultat.id).subscribe({\n            next: data => {\n              console.log(\"Detail Deleted\");\n            }, error: err => console.log(err)\n          })\n        } else if (!resultat.conforme && !this.resultat.conforme) {\n          this.resultatService.getDetailNonConformite(this.resultat.id).subscribe({\n            next: data => {\n              console.log(\"Getting detail\")\n              console.log(data)\n              this.detail.id=data.id\n              this.detail.idResultat=data.idResultat\n              console.log(this.detail)\n              this.resultatService.saveDetailNonConformite(this.detail).subscribe({\n                next: data => {\n                  console.log(\"Detail Updated\");\n                  console.log(data);\n                  this.router.navigate(['resultatPrelevements'])\n                }, error: err => console.log(console.log(\"Detail Updated failed\"), err)\n              });\n            }, error: err => console.log(\"Error in getting detail, err\")\n          })\n        }*/\n      },\n      error: err => console.log(err)\n    })\n  }\n\n\n}\n","<div class=\"header\"> Enregister les résultats de prélèvement d'échantillons:{{resultat.idPrelevement}}</div>\n<form [formGroup]=\"resultatFormGroup\" (ngSubmit)=\"onSubmit()\" #f=\"ngForm\">\n    <div class=\"my_container\">\n        <div class=\"Nom\">\n            <label>Numéro BA:</label>\n            <input placeholder=\"ex:2334\" type=\"text\" formControlName=\"numeroBA\"  name=\"numeroBA\" required number>\n        </div>\n\n        <div class=\"Nom\">\n            <label>Date de BA:</label>\n            <input type=\"date\" formControlName=\"dateBA\" name=\"date_BA\" required>\n        </div>\n\n        <div class=\"Nom\">\n            <label>Conformité:</label>\n            <select formControlName=\"conforme\"  name=\"choix\">\n                <option >Oui</option>\n                <option >Non</option>\n            </select>\n        </div>\n\n    </div>\n    <div  class=\"my_container2\" *ngIf=\"resultatFormGroup.value.conforme === 'Non'\" >\n        <div class=\"liner\"></div>\n        <div class=\"header\">Détail de non conformité</div>\n\n        <div class=\"my_container\" >\n\n            <div class=\"Nom\">\n                <label  >Numéro TA:</label>\n                <input placeholder=\"ex:2334\" type=\"text\" formControlName=\"numeroTA\"  name=\"NuméroTA\" required number>\n            </div>\n\n            <div class=\"Nom\">\n                <label>Date TA:</label>\n                <input  type=\"Date\" formControlName=\"dateTA\"  name=\"DateTA\" required>\n            </div>\n\n            <div class=\"Nom\">\n                <label>Détail:</label>\n                <input  type=\"text\" formControlName=\"detail\"  name=\"Détail\" required>\n            </div>\n        </div>\n\n    </div>\n    <button type=\"submit\" [disabled]=\"!f.valid\" class=\"btn btn-success\">Soumettre</button>\n</form>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}